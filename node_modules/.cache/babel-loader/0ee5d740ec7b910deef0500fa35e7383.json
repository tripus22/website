{"ast":null,"code":"import _taggedTemplateLiteral from \"/home/emily/Documents/spring22/capstone/website/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport _slicedToArray from \"/home/emily/Documents/spring22/capstone/website/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _templateObject,\n    _templateObject2,\n    _jsxFileName = \"/home/emily/Documents/spring22/capstone/website/src/settings subpages/profile settings/EditPass.js\",\n    _templateObject3,\n    _templateObject4,\n    _templateObject5,\n    _templateObject6,\n    _templateObject7,\n    _templateObject8,\n    _templateObject9,\n    _templateObject10,\n    _templateObject11;\n\nimport React, { useEffect, useRef } from \"react\";\nimport styled from \"styled-components\";\nimport { connect } from \"react-redux\";\nimport Nav from \"../../Components/Nav\";\nimport Footer from \"../../Components/Footer\";\nimport { useNavigate } from \"react-router\";\nimport { signInWithGoogle } from \"../../Firebase/firebase\";\nimport Google from '../../Images/Icons/Google.png';\nimport { store } from '../../store/TripUsStore';\nimport { gql, useMutation, useQuery } from \"@apollo/client\";\n\nfunction EditEmail(props) {\n  var _this = this;\n\n  var history = useNavigate();\n\n  function handleRoute(route) {\n    history(route);\n  }\n\n  var handleKeyDown = function handleKeyDown(e) {\n    if (e.key === 'Enter') {\n      handleClick();\n    }\n  };\n\n  var password = useRef(null);\n  var passwordVerified = useRef(null);\n  var oldPassword = useRef(null);\n\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      passwordInput = _React$useState2[0],\n      setPasswordInput = _React$useState2[1];\n\n  var _React$useState3 = React.useState(null),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      passwordVerifyInput = _React$useState4[0],\n      setPasswordVerifyInput = _React$useState4[1];\n\n  var _React$useState5 = React.useState(null),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      oldPasswordInput = _React$useState6[0],\n      setOldPasswordInput = _React$useState6[1];\n\n  var _React$useState7 = React.useState(false),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      clicked = _React$useState8[0],\n      setClicked = _React$useState8[1];\n\n  var handleClick = function handleClick(e) {\n    setClicked(true);\n\n    if (password.current.value === \"\") {\n      setPasswordInput(null);\n    } else {\n      setPasswordInput(password.current.value);\n    }\n\n    if (passwordVerified.current.value === \"\") {\n      setPasswordVerifyInput(null);\n    } else {\n      setPasswordVerifyInput(passwordVerified.current.value);\n    }\n\n    if (oldPassword.current.value === \"\") {\n      setOldPasswordInput(null);\n    } else {\n      setOldPasswordInput(oldPassword.current.value);\n    }\n  };\n\n  var VALIDATE_ACC = gql(_templateObject || (_templateObject = _taggedTemplateLiteral([\"query validateAcc ($ID: Int!){\\n        User(where: {User_ID: {_eq: $ID}}) {\\n            Password\\n            Email\\n        }\\n    }\"])));\n  var UPDATE_PASS = gql(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"mutation update_user ($ID: Int!, $Password: String!) {\\n        update_User_by_pk(\\n            pk_columns: {User_ID: $ID}\\n            _set: {Password: $Password\\n            }\\n        )\\n        {\\n            Email\\n        }\\n    }\"])));\n\n  var CheckMismatch = function CheckMismatch() {\n    var _useQuery = useQuery(VALIDATE_ACC, {\n      variables: {\n        ID: sessionStorage.getItem(\"userId\")\n      }\n    }),\n        data = _useQuery.data,\n        error = _useQuery.error,\n        loading = _useQuery.loading;\n\n    if (loading) {\n      return /*#__PURE__*/React.createElement(\"p\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 20\n        }\n      }, \"Changing password...\");\n    }\n\n    if (error) {\n      return /*#__PURE__*/React.createElement(\"e\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 20\n        }\n      }, error);\n    }\n\n    if (passwordVerifyInput !== passwordInput) {\n      return /*#__PURE__*/React.createElement(\"e\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 20\n        }\n      }, \" Passwords don't match! \");\n    } else if (oldPasswordInput !== data.User[0].Password) {\n      return /*#__PURE__*/React.createElement(\"e\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 24\n        }\n      }, \" Incorrect old password!\");\n    } else {\n      return /*#__PURE__*/React.createElement(UpdatePass, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 20\n        }\n      });\n    }\n\n    return null;\n  };\n\n  var UpdatePass = function UpdatePass() {\n    var _useMutation = useMutation(UPDATE_PASS),\n        _useMutation2 = _slicedToArray(_useMutation, 2),\n        update_pass = _useMutation2[0],\n        _useMutation2$ = _useMutation2[1],\n        data = _useMutation2$.data,\n        loading = _useMutation2$.loading,\n        error = _useMutation2$.error;\n\n    useEffect(function () {\n      update_pass({\n        variables: {\n          ID: sessionStorage.getItem(\"userId\"),\n          Password: passwordInput\n        }\n      });\n    }, []);\n\n    if (loading) {\n      return /*#__PURE__*/React.createElement(\"p\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 20\n        }\n      }, \"Updating your password...\");\n    }\n\n    if (data) {\n      window.location.reload(false);\n      return /*#__PURE__*/React.createElement(\"p\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 20\n        }\n      }, \"Password updated!\");\n    }\n\n    return null;\n  };\n\n  var CheckBlank = function CheckBlank() {\n    return /*#__PURE__*/React.createElement(\"e\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 16\n      }\n    }, \"Fields cannot be blank!\");\n  };\n\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Nav, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Content, {\n    theme: props.theme,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(SignUpForm, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 21\n    }\n  }, \"Change Password\"), /*#__PURE__*/React.createElement(Form, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    theme: props.theme.theme,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    ref: oldPassword,\n    onKeyDown: handleKeyDown,\n    type: \"password\",\n    name: \"password\",\n    placeholder: \"Old Password:\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 142\n    }\n  })), /*#__PURE__*/React.createElement(Row, {\n    theme: props.theme.theme,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    ref: password,\n    onKeyDown: handleKeyDown,\n    type: \"password\",\n    name: \"password\",\n    placeholder: \"New Password:\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 139\n    }\n  })), /*#__PURE__*/React.createElement(Row, {\n    theme: props.theme.theme,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    ref: passwordVerified,\n    onKeyDown: handleKeyDown,\n    type: \"password\",\n    name: \"password\",\n    placeholder: \"Verify New Password:\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 154\n    }\n  })), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(SubmitButton, {\n    onClick: handleClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 29\n    }\n  }, \"Set New Password\"), passwordInput !== null && passwordVerifyInput !== null ? /*#__PURE__*/React.createElement(CheckMismatch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 35\n    }\n  }) : clicked && /*#__PURE__*/React.createElement(CheckBlank, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 65\n    }\n  }))))), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 13\n    }\n  }));\n}\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return state;\n};\n\nexport default connect(mapStateToProps)(EditEmail);\nvar Container = styled.div(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n\"])));\nvar Content = styled.div(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n    display: flex;\\n    padding: 0 10%;\\n    height: 100vh;\\n    justify-content: center;\\n    align-items: center;\\n\"])));\nvar SignUpForm = styled.div(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"\\n    margin: 0 auto;\\n    border: 2px solid \", \";\\n    border-radius: 4px;\\n    padding: 25px 100px 50px;\\n    display: flex;\\n    flex-direction: column;\\n    align-items: center;\\n    \\n    p {\\n        margin: 0;\\n    }\\n\"])), function (_ref) {\n  var theme = _ref.theme;\n  return theme.toggleBorder;\n});\nvar Title = styled.p(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"\\n    font-size: 36px;\\n    margin: 0 0 50px 0;\\n    font-weight: 700;\\n\"])));\nvar Form = styled.form(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"\\n    width: 100%;\\n    margin-top: 20px;\\n\"])));\nvar Row = styled.div(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"\\n    display: flex;\\n    flex-direction: column;\\n\\n    input {\\n        border: none;\\n        outline: none;\\n        padding: 5px;\\n        font-size: 18px;\\n        border-bottom: solid 1px \", \";\\n        background-color: \", \";\\n        color: \", \";\\n\\n        &::placeholder {\\n            color: \", \";\\n            opacity: .6;\\n        }\\n    } \\n\\n    p {\\n        text-align: center;\\n        color: green;\\n    }\\n    e {\\n        text-align: center;\\n        color: red;\\n    }\\n\"])), function (_ref2) {\n  var theme = _ref2.theme;\n  return theme.text;\n}, function (_ref3) {\n  var theme = _ref3.theme;\n  return theme.body;\n}, function (_ref4) {\n  var theme = _ref4.theme;\n  return theme.text;\n}, function (_ref5) {\n  var theme = _ref5.theme;\n  return theme.text;\n});\nvar GoogleButton = styled.div(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"\\n    width: max-content;\\n    border: 2px solid #4285f4;\\n    padding: 5px 30px;\\n    border-radius: 45px;\\n    display: flex;\\n    align-items: center;\\n    cursor: pointer;\\n    transition: 300ms;\\n    background-color: #4285f4;\\n    margin: 20px 0;\\n\\n    p {\\n        margin-left: 20px;\\n        font-size: 16px;\\n        color: white;\\n        font-weight: 700;\\n    }\\n    \\n    img {\\n        width: 25spx;\\n        height: 25px;\\n        border-radius: 50%;\\n        background-color: white;\\n    }\\n\\n    :hover {\\n        opacity: .8;\\n        transition: 300ms;\\n    }\\n\"])));\nvar SubmitButton = styled(GoogleButton)(_templateObject10 || (_templateObject10 = _taggedTemplateLiteral([\"\\n    width: 100%;\\n    background-color: #308446;\\n    border: 2px solid #308446;\\n    display: flex;\\n    justify-content: center;\\n    font-weight: 700;\\n    color: white;\\n\"])));\nvar Login = styled.p(_templateObject11 || (_templateObject11 = _taggedTemplateLiteral([\"\\n    text-decoration: underline;\\n    cursor: pointer;\\n\"])));","map":{"version":3,"sources":["/home/emily/Documents/spring22/capstone/website/src/settings subpages/profile settings/EditPass.js"],"names":["React","useEffect","useRef","styled","connect","Nav","Footer","useNavigate","signInWithGoogle","Google","store","gql","useMutation","useQuery","EditEmail","props","history","handleRoute","route","handleKeyDown","e","key","handleClick","password","passwordVerified","oldPassword","useState","passwordInput","setPasswordInput","passwordVerifyInput","setPasswordVerifyInput","oldPasswordInput","setOldPasswordInput","clicked","setClicked","current","value","VALIDATE_ACC","UPDATE_PASS","CheckMismatch","variables","ID","sessionStorage","getItem","data","error","loading","User","Password","UpdatePass","update_pass","window","location","reload","CheckBlank","theme","mapStateToProps","state","Container","div","Content","SignUpForm","toggleBorder","Title","p","Form","form","Row","text","body","GoogleButton","SubmitButton","Login"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef} from \"react\";\nimport styled from \"styled-components\";\nimport {connect} from \"react-redux\";\nimport Nav from \"../../Components/Nav\";\nimport Footer from \"../../Components/Footer\";\nimport { useNavigate } from \"react-router\";\nimport { signInWithGoogle } from \"../../Firebase/firebase\";\nimport Google from '../../Images/Icons/Google.png';\nimport { store } from '../../store/TripUsStore';\nimport {gql, useMutation, useQuery} from \"@apollo/client\";\n\nfunction EditEmail(props) {\n    const history = useNavigate();\n    function handleRoute(route) {\n        history(route);\n    }\n\n    const handleKeyDown = (e) => {\n        if (e.key === 'Enter') {\n          handleClick();\n        }\n    }\n\n    let password = useRef(null);\n    let passwordVerified = useRef(null);\n    let oldPassword = useRef(null)\n\n    const [passwordInput, setPasswordInput] = React.useState(null);\n    const [passwordVerifyInput, setPasswordVerifyInput] = React.useState(null);\n    const [oldPasswordInput, setOldPasswordInput] = React.useState(null)\n    const [clicked, setClicked] = React.useState(false)\n\n\n    const handleClick = (e) => {\n        setClicked(true)\n\n        if (password.current.value === \"\") {\n            setPasswordInput(null);\n        } else {\n            setPasswordInput(password.current.value);\n        }\n\n        if (passwordVerified.current.value === \"\") {\n            setPasswordVerifyInput(null);\n        } else {\n            setPasswordVerifyInput(passwordVerified.current.value);\n        }\n\n        if (oldPassword.current.value === \"\") {\n            setOldPasswordInput(null);\n        } else {\n            setOldPasswordInput(oldPassword.current.value);\n        }\n\n    };\n\n    const VALIDATE_ACC = gql`query validateAcc ($ID: Int!){\n        User(where: {User_ID: {_eq: $ID}}) {\n            Password\n            Email\n        }\n    }`\n\n    const UPDATE_PASS = gql `mutation update_user ($ID: Int!, $Password: String!) {\n        update_User_by_pk(\n            pk_columns: {User_ID: $ID}\n            _set: {Password: $Password\n            }\n        )\n        {\n            Email\n        }\n    }`\n\n\n    const CheckMismatch = () => {\n        const {data, error, loading} = useQuery(VALIDATE_ACC, {\n            variables: {ID: sessionStorage.getItem(\"userId\")}\n        });\n\n        if (loading) {\n            return <p>Changing password...</p>\n        }\n\n        if (error) {\n            return <e>{error}</e>;\n        }\n\n        if (passwordVerifyInput !== passwordInput) {\n            return <e> Passwords don't match! </e>\n        } else if (oldPasswordInput !== data.User[0].Password) {\n                return <e> Incorrect old password!</e>\n        } else {\n            return <UpdatePass/>\n        }\n\n        return null;\n    }\n\n    const UpdatePass = () => {\n        const [update_pass, {data,loading,error}] = useMutation(UPDATE_PASS);\n\n        useEffect(() => {\n            update_pass({\n                variables : {\n                    ID: sessionStorage.getItem(\"userId\"),\n                    Password: passwordInput\n                }\n            });\n        }, []);\n\n        if (loading) {\n            return <p>Updating your password...</p>\n        }\n\n        if (data) {\n            window.location.reload(false);\n            return <p>Password updated!</p>\n        }\n        return null\n\n    }\n\n    const CheckBlank = () => {\n        return <e>Fields cannot be blank!</e>\n    }\n\n\n    return (\n        <Container>\n            <Nav />\n            <Content theme={props.theme}>\n                <SignUpForm>\n                    <Title>Change Password</Title>\n                    <Form>\n                    <Row theme={props.theme.theme}>\n                            {/* <label>Password:</label> */}\n                            <input ref={oldPassword} onKeyDown={handleKeyDown} type=\"password\" name=\"password\" placeholder=\"Old Password:\" /><br></br>\n                        </Row>\n                        <Row theme={props.theme.theme}>\n                            {/* <label>Password:</label> */}\n                            <input ref={password} onKeyDown={handleKeyDown} type=\"password\" name=\"password\" placeholder=\"New Password:\" /><br></br>\n                        </Row>\n                        <Row theme={props.theme.theme}>\n                            {/* <label>Password:</label> */}\n                            <input ref={passwordVerified} onKeyDown={handleKeyDown} type=\"password\" name=\"password\" placeholder=\"Verify New Password:\" /><br></br>\n                        </Row>\n                        <Row>\n                            <SubmitButton onClick={handleClick}>Set New Password</SubmitButton>\n                            {passwordInput !== null && passwordVerifyInput !== null\n                                ? <CheckMismatch/> : clicked && <CheckBlank/>}\n                        </Row>\n\n                    </Form>\n                    \n                </SignUpForm>\n            </Content>\n            <Footer />\n        </Container>\n    )\n}\n\nconst mapStateToProps = (state) => {\n    return state;\n}\n\nexport default connect(mapStateToProps)(EditEmail);\n\nconst Container = styled.div`\n`;\n\nconst Content = styled.div`\n    display: flex;\n    padding: 0 10%;\n    height: 100vh;\n    justify-content: center;\n    align-items: center;\n`;\n\nconst SignUpForm = styled.div`\n    margin: 0 auto;\n    border: 2px solid ${({ theme }) => theme.toggleBorder};\n    border-radius: 4px;\n    padding: 25px 100px 50px;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    \n    p {\n        margin: 0;\n    }\n`;\n\nconst Title = styled.p`\n    font-size: 36px;\n    margin: 0 0 50px 0;\n    font-weight: 700;\n`;\n\nconst Form = styled.form`\n    width: 100%;\n    margin-top: 20px;\n`;\n\nconst Row = styled.div`\n    display: flex;\n    flex-direction: column;\n\n    input {\n        border: none;\n        outline: none;\n        padding: 5px;\n        font-size: 18px;\n        border-bottom: solid 1px ${({ theme }) => theme.text};\n        background-color: ${({ theme }) => theme.body};\n        color: ${({ theme }) => theme.text};\n\n        &::placeholder {\n            color: ${({ theme }) => theme.text};\n            opacity: .6;\n        }\n    } \n\n    p {\n        text-align: center;\n        color: green;\n    }\n    e {\n        text-align: center;\n        color: red;\n    }\n`;\n\nconst GoogleButton = styled.div`\n    width: max-content;\n    border: 2px solid #4285f4;\n    padding: 5px 30px;\n    border-radius: 45px;\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n    transition: 300ms;\n    background-color: #4285f4;\n    margin: 20px 0;\n\n    p {\n        margin-left: 20px;\n        font-size: 16px;\n        color: white;\n        font-weight: 700;\n    }\n    \n    img {\n        width: 25spx;\n        height: 25px;\n        border-radius: 50%;\n        background-color: white;\n    }\n\n    :hover {\n        opacity: .8;\n        transition: 300ms;\n    }\n`;\n\nconst SubmitButton = styled(GoogleButton)`\n    width: 100%;\n    background-color: #308446;\n    border: 2px solid #308446;\n    display: flex;\n    justify-content: center;\n    font-weight: 700;\n    color: white;\n`;\n\nconst Login = styled.p`\n    text-decoration: underline;\n    cursor: pointer;\n`;"]},"metadata":{},"sourceType":"module"}